h1. Sidekick [Draft]

Sidekick is a command line tool to automatically trigger certain tasks following certain events, as defined in a @.sidekick@ file in your project folder.

You would typically run it in the background while coding, to automatize things like restarting development servers on file changes, or recompiling assets. Other use cases could be continous testing, periodically running a command, etc.

The main code is approx 100 lines of code including documentation, excluding triggers and helpers.


h2. Basic usage

After running @gem install sidekick@, invoke it using the @sidekick@ shell command. You should have a .sidekick file in your project directory for this. A sample file:

<pre>
<code lang='ruby'>
watch '**/*.rb' do |paths|
  restart_passenger
end

watch 'assets/**/*.coffee' do |paths|
  puts `coffee -b -c -o public/~/js assets/js` #bare, compile, output
end

watch 'assets/**/*.sass' do |paths|
  puts `sass --update assets/css:public/~/css`
end
</code>
</pre>

The @watch@ method above is a trigger, while @restart_passenger@ is an example of a helper method. The currently available triggers and helpers are:

Triggers:

* watch(paths)

Helpers:

* restart_passenger


h2. Writing new sidekicks and helpers

Sidekick is easy to extend. To add more helpers, simply add methods to @Sidekick::Helpers@. To add triggers, use @Sidekick.register@. As an example, the following code implements @watch@ trigger used above:

<pre>
<code lang='ruby'>
Sidekick.register(:watch) do |callback, glob|
  fs = Sidekick::Watch::FSObserver.new(glob)

  Sidekick.timeshare do
    unless (changes = fs.changed).empty?
      Sidekick.log "watch #{changes.inspect}"
      callback.call(changes)
    end
  end
end
</code>
</pre>

The @Sidekick.timeshare@ block seen above will be executed every second, and is a convenient way to do periodical checks without blocking or forking.


h2. Inspired by

* "Guard":http://github.com/guard/guard


h2. Last words

Let me know if you write some new triggers or helpers, so they can be gathered here for others to use.


h3. Copyright

Copyright (c) 2010 Jostein Berre Eliassen. See LICENSE for details.
